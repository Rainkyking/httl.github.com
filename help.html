<!doctype html>
<!--[if lt IE 7]><html class="no-js ie6 oldie" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]><html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><html class="no-js ieg8" lang="en"> <![endif]-->
<html>
<head>
<meta charset="utf-8">
<title>HTTL - 开源Java模板引擎</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="apple-touch-icon" href="img/apple-touch-icon.png"/>
<link rel="shortcut icon" href="favicon.ico" />
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato:400,700" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/style-mobile.css" media="only screen and (max-width: 480px)" />
<link rel="stylesheet" type="text/css" href="css/httl.css" />
<link rel="stylesheet" type="text/css" href="css/httl-mobile.css" media="only screen and (max-width: 480px)" />
<link rel="stylesheet" type="text/css" href="css/shCoreDefault.css" />
<script type="text/javascript" src="js/modernizr-2.0.6.min.js"></script>
<script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="js/httl.js"></script>
<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>
<body class="home ">
    <a href="http://github.com/httl/httl"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub" class="fork-me-on-github"></a>
    <div class="container">
        <header>
            <div class="logo">
	           <a href="/">HTTL</a>
            </div>
            <div id="headline" class="headline">
                <h1>模板引擎</h1>
                <ul>
                  <li>简洁友好的模板语法</li>
                  <li>精益求精的性能优化</li>
                  <li>高质量的设计与实现</li>
                </ul>
            </div>
        </header>
        <nav class="primary-nav">
            <a href="/"><img src="img/icon-overview.png"> 概述</a>
            <a href="download.html"><img src="img/icon-download.png"> 下载</a>
            <a href="example.html"><img src="img/icon-example.png"> 示例</a>
            <a href="syntax.html"><img src="img/icon-syntax.png"> 语法</a>
            <a href="config.html"><img src="img/icon-config.png"> 配置</a>
            <a href="integration.html"><img src="img/icon-integration.png"> 集成</a>
            <a href="design.html"><img src="img/icon-design.png"> 设计</a>
            <a href="help.html"><img src="img/icon-help.png"> 帮助</a>
        </nav>
    <div class="content">
      <div class="body-content ">
        <section>

<h1>帮助</h1>

<p>如果使用过程中遇到问题，可以
<ol>
<li>提交问题到：<a href="https://github.com/httl/httl/issues">HTTL问题管理</a>
<li>参与QQ群：184287288
</ol>
</p>

<h2>成员</h2>

<h3>创建者 (Founder)</h3>

<a href="http://weibo.com/liangfei0201"><img alt="liangfei" src="images/liangfei.png" /></a>
<ul>
<li>梁飞 (天猫-平台架构 高级技术专家) 杭州</li>
<li>邮箱：liangfei0201 (At) gmail (Dot) com</li>
<li>博客：<a href="http://javatar.iteye.com">http://javatar.iteye.com</a></li>
<li>微博：<a href="http://weibo.com/liangfei0201">http://weibo.com/liangfei0201</a></li>
<li>贡献：框架设计，引擎实现，SPI实现。</li>
</ul>

<h3>提交者 (Committer)</h3>

<a href="http://weibo.com/oldratlee"><img alt="liding" src="images/liding.png" /></a>
<ul>
<li>李鼎 (支付宝-ACE 高级开发工程师)</li>
<li>邮箱：oldratlee (At) gmail (Dot) com</li>
<li>博客：<a href="http://oldratlee.com">http://oldratlee.com</a></li>
<li>微博：<a href="http://weibo.com/oldratlee">http://weibo.com/oldratlee</a></li>
<li>贡献：配置加载，异常改进，问题修复。</li>
</ul>

<h3>贡献者 (Contributor)</h3>

<a href="http://my.oschina.net/myaniu"><img alt="liding" src="images/lifei.jpg" /></a>
<ul>
<li>李飞 (朗华 - 技术主管) 西安</li>
<li>QQ: 27982221</li>
<li>邮箱：lifei188 (AT) vip (DOT) qq (DOT) com</li>
<li>博客：<a href="http://my.oschina.net/myaniu/blog">http://my.oschina.net/myaniu/blog</a></li>
<li>贡献：JFinal和HTTL整合：<a href="https://github.com/httl/httl/issues/59">#115</a></li>
<li></li>
</ul>

Xwinie
<ul>
<li>豆豆熊 (Freeborders - 数据库管理员)</li>
<li>QQ: 103831536</li>
<li>邮箱：xwinie (At) gmail (Dot) com</li>
<li>博客：<a href="http://my.oschina.net/xwinie/blog">http://my.oschina.net/xwinie/blog</a></li>
<li>贡献：Nutz和HTTL整合：<a href="https://github.com/httl/httl/issues/59">#59</a></li>
</ul>

ZQQ9
<ul>
<li>邮箱：zqq_90 (At) 163 (Dot) com</li>
<li>贡献：类型问题修复：<a href="https://github.com/httl/httl/pull/64">#64</a></li>
</ul>

Subchen
<ul>
<li>贡献：移除指令空白行实现：<a href="https://github.com/httl/httl/issues/89">#89</a></li>
</ul>

<script type="text/javascript" src="js/jquery.githubRepoWidget.js"></script>
<div class="github-widget" data-repo="httl/httl"></div>

<h1>解答</h1>

<h2>为什么要用#set声明变量类型?</h2>

<p>强制要求声明变量#set定义，是为了明确模板的输入，这样可以强类型编译，提升性能。</p>

<p>也方便模板的维护，弱类型对长期维护运营的互联网应用极为不利，上千个工程师对模板修修补补。</p>

<p>谁还记得a对象有哪些属性，翻代码翻文档，有人改了a对象的某个属性，不会关联，也不提示。</p>

<p>就算开发IDE编辑器，也不能自动提示，也不能报错，等运行时检测，是很影响开发效率的。</p>

<p>阿里内部在给Velocity开发IDE编辑器就遇到了很大阻力，不得不通过注释给模板增加了类型定义。</p>

<p>参见：<a href="http://www.infoq.com/cn/articles/hk-semi-static-language">http://www.infoq.com/cn/articles/hk-semi-static-language</a></p>

<h2>如何实现像JSP自定义标签的功能?</h2>

<p>HTTL为防止模板复杂化，保持最简指令集，所以不允许用户扩展指令集，而通过扩展函数来实现相同功能。</p>

<p>自定义标签：&lt;hasPrivilege resource="foo"&gt; ... &lt;/hasPrivilege&gt;</p>

<p>可替换为方法扩展：#if(hasPrivilege("foo")) ... #end</p>

<p>只需配置：import.methods+=com.your.YourPrivilegeStaticMethodClass</p>

<h2>出现编译失败异常怎么办？</h2>

<p>HTTL在编译失败后，会自动开启-Xlint:unchecked参数重新编译，
所以用户得到的异常信息中，已经包含了详细的JDK编译失败信息。</p>

<p>如果分析不出异常原因，HTTL同时会将生成的Java的代码打印在日志中，
你可以将代码复制出来，放到IDE中，看IDE的错误提示。</p>

<h2>出现类或包找不到异常怎么办？</h2>

<p>请检查httl，以及你所使用的类，是否在classpath下。</p>

<p>请检查import.packages的包名是否正确。</p>

<p>如果是JdkCompiler出现问题，可以尝试换成JavassistCompiler试试，确认是否为JdkCompiler的classpath加载问题。</p>

<h2>出现找不到属性或方法怎么办?</h2>

<p>如果出现以下异常信息：</p>

<p>No such property xxx in class java.lang.Object</p>

<p>No such method xxx() in class java.lang.Object</p>

<p>通常是变量的类型没有定义，请在模板中加入变量类型声明：#set(Xxx xxx)</p>

<h2>出现改模板后不能生效怎么办？</h2>

<p>HTTL在启动时会打印INFO日志显示配置的加载路径，如：</p>

<pre><code>INFO: Load httl config from /home/foo/httl.properties in classpath.</code></pre>

<p>你可以看下你的配置是否是日志打印位置上的那份，避免有多份httl.properties配置时，加载错了配置文件。</p>

<p>如果有多份配置，HTTL会打印WARN日志提醒用户，如：</p>

<pre><code>WARN: Multi httl config in classpath, conflict configs: [/home/foo/httl.properties, /home/foo/conf/httl.properties]. Please keep only one config.</code></pre>

<p>并且，HTTL在加载第一个模板时，会打印INFO日志显示模板所在绝对路径，如：</p>

<pre><code>INFO: Load httl template from RELOADABLE directory /home/foo/templates by ClasspathLoader.</code></pre>

<p>你可以看下你的模板是否在日志打印的模板目录下，避免修改的模板不在加载目录下，其中RELOADABLE表示开启了热加载，在没有开启热加载时修改模板需要重启。</p>

<h2>模板渲染出现乱码怎么办?</h2>

<p>如果出现乱码问题，请检查HTTL的编码配置：</p>

<p>input.encoding=UTF-8</p>

<p>output.encoding=UTF-8</p>

<p>缺省值都为file.encoding，即本地操作系统文件编码。</p>

<p>另外，MVC集成，缺省会将output.encoding的值写入response.setEncodingCharset()中，</p>

<p>当然，你也可以通过配置response.encoding=null关闭对response编码的自动设置，</p>

<p>如果使用OutputStream输出模板，请一定要确保response.encoding和output.encoding一致，否则输出内容会乱码。</p>

<p>请注意，input.encoding指的是从磁盘加载模板的编码，和request.getEncodingCharset并无关联，可以使用不同编码。</p>

<h2>指令名和文本相接怎么办?</h2>

<p>如：#elseTEXT，可用无参括号隔开，如：#if(x)AAA#else()BBB#end()CCC</p>

<h2>${}占位符能否嵌套?</h2>

<p>HTTL不支持占位符嵌套，如：${include("${dir}/file")}，占位符内请用加号拼接字符串，如：${include(dir + "/file")}</p>

<h1>参与</h1>

<h2>参与方式</h2>

<p>你可以通过<a href="https://github.com/httl/httl/pulls">github pull</a>将你的变更发给我们。</p>

<p>你也可以直接将代码，发邮件给我们：liangfei0201 (At) gmail (Dot) com</p>

<h2>参与内容</h2>

<h3>文档补充</h3>

<p>如果你发现有缺少的文档，或解答过的FAQ，使用心得，以及你对细节的理解，都可以发邮件给我们，我们将贴在此网站上，供其他人交流学习。</p>

<h3>模板测试</h3>

<p>你也可以帮忙测试更多场景的模板，只需提供测试模板和预期的结果文件即可，如：</p>

<p>已有测试模板：<a href="https://github.com/httl/httl/tree/master/httl/src/test/resources/comment/templates">src/test/resources/comment/templates</a>

<p>已有测试结果：<a href="https://github.com/httl/httl/tree/master/httl/src/test/resources/comment/results">src/test/resources/comment/results</a>

<p>可运行httl.test.TemplateTest测试类，它会自动扫描和执行templates下的所有模板，并用results下的同名加.txt后缀的文件内容断言输出。</p>

<h3>问题修复</h3>

<p>你可以帮忙修复<a href="https://github.com/httl/httl/issues">github issues</a>上的问题。</p>

<h3>核心改进</h3>

<p>如果你有兴趣花较多时间参与HTTL，并且有一定开发实力，可以加入核心的改进：</p>

<ul>
<li>解释执行与编译执才的自动切换，类似于JVM的JIT。</li>
<li>完整的泛型推导，和Java的泛型推导相同。</li>
<li>生成字节码细节上的优化，比如减少instanceof，减少反射，减少装箱。</li>
<li>异常信息友好性提示，比如运行时业务报错，提示在模板中的位置。</li>
<li>在热加载时，支持卸载之前编译的模板类。</li>
<li>支持磁盘缓存字节码，减少重启时编译。</li>
<li>重构AST树，使之可扩展。</li>
</ul>

<h3>扩展实现</h3>

<p>你也可以实现<a href="integration.html#扩展集成">HTTL的扩展点</a>，包括：</p>

<ul>
<li>Static，静态方法</li>
<li>Loader，模板加载</li>
<li>Resolver，变量决策</li>
<li>Formatter，输出格式化</li>
<li>Filter，输出过滤</li>
<li>Converter，渲染参数转换</li>
<li>Interceptor，渲染过程拦截</li>
<li>Listener，渲染过程监听</li>
</ul>

<h3>框架集成</h3>

<p>你也可以帮忙集成各种MVC框架，以及其它需要使用模板的场景。</p>

<h3>辅助工具</h3>

<p>你也可以帮忙实现Eclipse, IDEA等模板开发插件，以及Debug调试器，测试查看器等等。</p>

<div id="docUp" style="position: fixed; right: 80px; bottom: 80px; display: none;"><a href="#" onclick="document.body.scrollTop = 0; return false;"><img src="img/up.png" /><br/>回顶部</a></div>
</section>
</div>

<aside>
<div class="standard-right-nav">
  <p>文档目录</p>
  <div id="docIndex" class="nav-inner"></div>
</div>
</aside>   
 
</div>

    <footer>
      <nav class="footer-secondary-nav">
        <div class="companies">
          <p>版权所有 2011-<script type="text/javascript">document.write(new Date().getYear() + 1900);</script> HTTL开发团队.<br/><br/>本站可自适应: 手机, 平板, 电脑等.<br/></p>
        </div>
      </nav>
    </footer>
  </div>
</body>
</html>